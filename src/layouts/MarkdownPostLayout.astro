---
import BaseLayout from "./BaseLayout.astro";
const { frontmatter } = Astro.props;

const formattedDate = new Date(frontmatter.pubDate).toLocaleDateString(
  "es-ES",
  {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric",
  },
);
---

<BaseLayout pageTitle={frontmatter.title}>
  <article class="post-article">
    <div class="container animate-fade-in-up">
      <!-- Editorial Header -->
      <header class="post-header">
        <div class="meta-top">
          {
            frontmatter.tags && (
              <div class="tags-wrapper">
                {frontmatter.tags.map((tag) => (
                  <span class="category-tag">#{tag}</span>
                ))}
              </div>
            )
          }
          <time datetime={frontmatter.pubDate.toISOString()}>
            {formattedDate}
          </time>
        </div>

        <h1 class="post-title">
          {frontmatter.title}
        </h1>

        <div class="author-meta">
          <div class="author-avatar-img">
            <img src="/cheito-author.jpg" alt="Cheito DÃ­az" />
          </div>
          <div class="author-info">
            <span class="by">Por</span>
            <span class="author-name">{frontmatter.author}</span>
          </div>
        </div>
      </header>

      <!-- Featured Image (Rectangular, Clean, No Overlay) -->
      {
        frontmatter.image && (
          <div class="hero-image-wrapper">
            <img
              src={frontmatter.image.url}
              alt={frontmatter.image.alt}
              class="hero-image"
            />
          </div>
        )
      }

      <div class="post-content-wrapper delay-200">
        <!-- Lead / Entradilla -->
        {
          frontmatter.description && (
            <div class="post-lead">
              <p>{frontmatter.description}</p>
            </div>
          )
        }

        <div class="prose-content">
          <slot />
        </div>

        <div class="post-footer">
          <a href="/blog/" class="back-link">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              ><path d="M19 12H5"></path><path d="M12 19l-7-7 7-7"></path></svg
            >
            Volver a Noticias
          </a>
        </div>
      </div>
    </div>
  </article>
</BaseLayout>

<style>
  .post-article {
    padding-top: 2rem;
    padding-bottom: 4rem;
  }

  /* Header Styles */
  .post-header {
    max-width: 900px;
    margin: 0 auto 2.5rem;
    text-align: left;
  }

  .meta-top {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
    font-family: var(--font-heading, sans-serif);
    font-size: 0.9rem;
    color: #666;
  }

  .meta-top time {
    text-transform: capitalize;
    font-weight: 500;
  }

  .tags-wrapper {
    display: flex;
    gap: 0.5rem;
  }

  .category-tag {
    color: var(--color-primary);
    font-weight: 800;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
  }

  .post-title {
    font-size: clamp(2.5rem, 5vw, 3.5rem);
    line-height: 1.1;
    margin-bottom: 2rem;
    text-wrap: balance;
    font-weight: 800;
    color: var(--color-text-heading, #111);
  }

  .author-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
    border-top: 1px solid #eee;
    padding-top: 1.5rem;
    width: 100%;
  }

  .author-avatar-img {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
  }

  .author-avatar-img img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    margin: 0 !important; /* Override potential prose margins */
    border-radius: 50%;
  }

  .author-info {
    display: flex;
    flex-direction: column;
    font-size: 0.9rem;
    line-height: 1.2;
  }

  .author-info .by {
    color: #888;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .author-info .author-name {
    font-weight: 700;
    color: #111;
  }

  /* Image Styles */
  .hero-image-wrapper {
    width: 100%;
    max-width: 1100px; /* Slightly wider than text for visual rhythm */
    margin: 0 auto 3.5rem;
    border-radius: 8px;
    overflow: hidden;
    /* Clean rectangular, no overlay */
    background: #f0f0f0;
  }

  .hero-image {
    width: 100%;
    height: auto;
    display: block;
    aspect-ratio: 16 / 9; /* Enforce standard ratio */
    object-fit: cover;
  }

  /* Content Wrapper */
  .post-content-wrapper {
    max-width: 800px;
    margin: 0 auto;
    position: relative;
  }

  /* Lead / Entradilla Styling */
  .post-lead {
    font-size: 1.85rem;
    line-height: 1.5;
    color: #111;
    margin-bottom: 3rem;
    font-weight: 600;
    font-family: var(
      --font-heading,
      serif
    ); /* Use heading font for punchy lead */
    letter-spacing: -0.02em;
  }

  /* Typography / Prose Styles */
  .prose-content {
    font-size: 1.125rem;
    line-height: 1.8;
    color: #333;
    font-family: var(--font-sans);
  }

  /* Scoped styles */
  .prose-content :global(h2) {
    font-size: 2rem;
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    color: var(--color-text-heading, #111);
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  .prose-content :global(h3) {
    font-size: 1.5rem;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    color: var(--color-text-heading, #111);
    font-weight: 700;
  }

  .prose-content :global(p) {
    margin-bottom: 1.5rem;
  }

  .prose-content :global(a) {
    color: var(--color-primary);
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 3px;
    transition: all 0.2s;
    font-weight: 600;
  }

  .prose-content :global(a:hover) {
    color: var(--color-accent);
    background: rgba(var(--color-primary-rgb), 0.1);
  }

  .prose-content :global(ul),
  .prose-content :global(ol) {
    margin-bottom: 1.5rem;
    padding-left: 1.5rem;
  }

  .prose-content :global(li) {
    margin-bottom: 0.5rem;
  }

  .prose-content :global(li::marker) {
    color: var(--color-primary);
    font-weight: bold;
  }

  .prose-content :global(blockquote) {
    border-left: 4px solid var(--color-primary);
    padding-left: 1.5rem;
    margin: 2rem 0;
    font-style: italic;
    font-size: 1.25rem;
    color: #444;
  }

  .prose-content :global(img) {
    width: 100%;
    height: auto;
    border-radius: 4px;
    margin: 2rem 0;
  }

  /* Footer Links */
  .post-footer {
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 1px solid #eee;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: #666;
    font-weight: 600;
    text-decoration: none;
    transition: color 0.2s;
  }

  .back-link:hover {
    color: var(--color-primary);
  }

  /* Animations */
  .animate-fade-in-up {
    animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    opacity: 0;
    transform: translateY(20px);
  }

  .delay-200 {
    animation-delay: 0.2s;
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .post-title {
      font-size: 2rem;
      margin-bottom: 1.5rem;
    }

    .post-lead {
      font-size: 1.3rem;
    }

    .meta-top {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }
  }
</style>
